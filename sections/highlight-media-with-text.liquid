{% if section.index <= 2 %}
  {{ 'highlight-media-with-text.css' | asset_url | preload_tag: as: 'style' }}
{% endif %}
{{ 'highlight-media-with-text.css' | asset_url | stylesheet_tag }}
{% liquid
  if section.settings.section_container_width == 'global'
    assign containerClass = settings.container_width
  else
    assign containerClass = section.settings.section_container_width
  endif
%}

{% liquid
  assign media_size = section.settings.media_ratio
  if media_size == 'landscape'
    assign media_ratio = '75'
  elsif media_size == 'square'
    assign media_ratio = '100'
  elsif media_size == 'portrait'
    assign media_ratio = '130'
  endif
%}

{%- capture corner_style -%}
      {% if section.settings.corner_style == 'top' %}
          round-section round-top
          {% elsif section.settings.corner_style == 'bottom' %}
          round-section round-bottom
          {% elsif section.settings.corner_style == 'both' %}
          round-section round-bottom round-top
      {% endif %}
  {%- endcapture -%}
<div class="section-wrapper scheme-{{ section.settings.color_scheme }} section-spacing pos-relative {{ corner_style }} section-{{ section.settings.section_background }} {% if section.settings.shape != 'none' %} section-shape-{{ section.settings.shape_position }} shape-{{ section.settings.shape }}{% endif %}">
  {% if section.settings.background_image != blank %}
    <div class="background-overlay-image media-overlay overlay-style-{{ section.settings.overlay_style }} blur-background-{{ section.settings.blur_background_image }}">
      {% render 'lazy-images', image: section.settings.background_image %}
    </div>
  {% endif %}
  <div class="highlight-media-with-text-inner">
    <div class="{{ containerClass }}">
      <div class="heading-media-text">
        {% if section.settings.heading != blank %}
          <h2 class="highlight-media-heading {{ section.settings.heading_font }} heading-style-{{ section.settings.heading_style }}">
            {% assign split_heading = section.settings.heading | split: ' ' %}
            {% for heading in split_heading %}
              {% if heading != blank %}
                <span>{{ heading }}</span>
              {% endif %}
            {% endfor %}
          </h2>
        {% endif %}
        <div class="heading-media-text-slider-wrapper">
          {% if section.blocks.size > 1 %}
            <swiper-slideshow>
              <div
                class="swiper highlight-text-swiper"
                data-swiper='
                  {
                    "effect": "cards",
                    "grabCursor": true,
                    "initialSlide": 2,
                    "speed": 500,
                    "loop": false,
                    "rotate": true,
                    "mousewheelControl": false,
                    {% if section.settings.auto_rotate %}
                      "autoplay":  {
                        "delay": {{ section.settings.change_slides_speed | times: 1000 }},
                        "disableOnInteraction": false
                      },
                      {% endif %}
                      "navigation": {
                      "enabled": true,
                      "nextEl": ".swiper-button-next-{{ section.id }}",
                      "prevEl": ".swiper-button-prev-{{ section.id }}"
                    }
                  }
                '
              >
          {% endif %}
          <div class="{% if section.blocks.size > 1 %}swiper-wrapper{% else %}heading-media-text-slider-single-slide{% endif %}">
            {% for block in section.blocks %}
              {% liquid
                capture current
                  cycle section.id: 1, 2, 3, 4
                endcapture
              %}
              {% if section.blocks.size > 1 %}
                <div class="swiper-slide">
              {% endif %}
             {% if block.settings.media_link != blank %}
            <a href="{{ block.settings.media_link }}"> 
            {% endif %}
              <div class="media" style="--image-ratio: {{ media_ratio }}%;">
                {% if block.settings.video != blank %}
                  {{
                    block.settings.video
                    | video_tag:
                      image_size: '1100x',
                      class: 'highlight-media-video',
                      autoplay: true,
                      loop: true,
                      mute: true,
                      controls: false,
                      preload: 'none'
                  }}
                {% elsif block.settings.image != blank %}
                  {{ block.settings.image | image_url: width: null | image_tag }}
                {% else %}
                  {{ 'product-apparel-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
                {% endif %}
              </div>
              {% if block.settings.media_link != blank %}
              </a> 
              {% endif %}
              {% if section.blocks.size > 1 %}
                </div>
              {% endif %}
            {% endfor %}
          </div>
          {% if section.blocks.size > 1 %}
            </div>
            </swiper-slideshow>
          {% endif %}
          {% if section.blocks.size > 1 %}
            <div class="section-header-slideshow-nav-wrapper gap-10 d-grid align-items-center">
              <button class="slideshow-nav-btn slideshow-prev cursor-pointer swiper-button-prev-{{ section.id }} arrow-style-{{ settings.arrow_style }}">
                {% if settings.arrow_style == 'star' %}
                  {% render 'svg-icons', icon: 'star-arrow-prev' %}
                {% else %}
                  {% render 'svg-icons', icon: 'arrow-icon-prev' %}
                {% endif %}
              </button>
              <button class="slideshow-nav-btn slideshow-next cursor-pointer swiper-button-next-{{ section.id }} arrow-style-{{ settings.arrow_style }}">
                {% if settings.arrow_style == 'star' %}
                  {% render 'svg-icons', icon: 'star-arrow-next' %}
                {% else %}
                  {% render 'svg-icons', icon: 'arrow-icon-next' %}
                {% endif %}
              </button>
            </div>
          {% endif %}
        </div>
      </div>
      {% if section.settings.description != blank %}
        <div class="highlight-media-with-text-description text-center small-width">
          <p class="{{ section.settings.description_size }}">{{ section.settings.description | newline_to_br }}</p>
        </div>
      {% endif %}
    </div>
  </div>

  {% if section.settings.shape != 'none' %}
    <div class="section-shape-wrapper shape-position-{{ section.settings.shape_position }} shape-flip-{{ section.settings.flip_shape }}">
      {% render 'shapes', shape: section.settings.shape %}
    </div>
  {% endif %}
</div>
<style>
      #shopify-section-{{ section.id }}{
        --top-spacing: {{ section.settings.top_space_desktop }}px;
        --bottom-spacing: {{ section.settings.bottom_space_desktop }}px;
        --round-section-radius: {{ section.settings.corner_radius }}px;
        --highlight-heading-size: {{ section.settings.desktop_font_size }}px;
      }

      @media only screen and (max-width:767px) {
        #shopify-section-{{ section.id }}{
          --top-spacing: {{ section.settings.top_space_mobile }}px;
          --bottom-spacing: {{ section.settings.bottom_space_mobile }}px;
          --highlight-heading-size: {{ section.settings.mobile_font_size }}px;
        }
      }
      {% if section.settings.section_visibility == 'large' %}
    @media(max-width: 767px) {
      #shopify-section-{{ section.id }} {
        display: none !important;
      }
    }
  {% elsif section.settings.section_visibility == 'small' %}
  @media(min-width: 768px) {
    #shopify-section-{{ section.id }} {
      display: none !important;
    }
  }
  {% endif %}
</style>
{% schema %}
{
  "name": "t:sections.highlight-media-with-text.name",
  "tag": "section",
  "class": "highlight-media-with-text",
  "disabled_on": {
    "groups": ["header", "footer", "custom.Overlay"]
  },
  "settings": [
    {
      "type": "select",
      "id": "section_visibility",
      "label": "t:sections.all.section_visibility.label",
      "default": "always",
      "options": [
        {
          "label": "t:sections.all.section_visibility.always.label",
          "value": "always"
        },
        {
          "label": "t:sections.all.section_visibility.small.label",
          "value": "small"
        },
        {
          "label": "t:sections.all.section_visibility.large.label",
          "value": "large"
        }
      ]
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "primary"
    },
    {
      "type": "select",
      "id": "section_background",
      "label": "t:sections.all.section_background.label",
      "default": "solid",
      "options": [
        {
          "label": "t:sections.all.section_background.solid.label",
          "value": "solid"
        },
        {
          "label": "t:sections.all.section_background.gradient.label",
          "value": "gradient"
        }
      ]
    },
    {
      "type": "select",
      "id": "section_container_width",
      "label": "t:sections.all.section_container_width.label",
      "default": "global",
      "options": [
        {
          "label": "t:sections.all.section_container_width.global.label",
          "value": "global"
        },
        {
          "label": "t:sections.all.section_container_width.container-sm.label",
          "value": "container-sm"
        },
        {
              "label": "t:sections.all.section_container_width.container.label",
              "value": "container-md"
            },
            {
              "label": "t:sections.all.section_container_width.container-md.label",
              "value": "container"
            },
        {
          "label": "t:sections.all.section_container_width.container-fullwidth.label",
          "value": "container-fullwidth"
        },
        {
          "label": "t:sections.all.section_container_width.no-container.label",
          "value": "no-container"
        }
      ]
    },
    {
      "type": "select",
      "id": "corner_style",
      "default": "none",
      "label": "t:sections.all.section_corner_style.label",
      "options": [
        {
          "value": "top",
          "label": "t:sections.all.section_corner_style.top.label"
        },
        {
          "value": "bottom",
          "label": "t:sections.all.section_corner_style.bottom.label"
        },
        {
          "value": "both",
          "label": "t:sections.all.section_corner_style.both.label"
        },
        {
          "value": "none",
          "label": "t:sections.all.section_corner_style.none.label"
        }
      ]
    },
    {
      "type": "range",
      "id": "corner_radius",
      "label": "t:settings_schema.global.settings.corner_radius.label",
      "default": 70,
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "t:sections.all.headers.background"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "t:sections.all.background.label"
    },
    {
      "type": "checkbox",
      "id": "blur_background_image",
      "label": "t:sections.all.blur_background_image.label",
      "default": false
    },
    {
      "type": "select",
      "id": "overlay_style",
      "label": "t:sections.all.overlay_style.label",
      "default": "solid",
      "options": [
        {
          "value": "solid",
          "label": "t:sections.all.overlay_style.solid.label"
        },
        {
          "value": "gradient",
          "label": "t:sections.all.overlay_style.gradient.label"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "auto_rotate",
      "label": "t:sections.highlight-media-with-text.settings.auto_rotate.label",
      "default": true
    },
    {
      "type": "range",
      "id": "change_slides_speed",
      "min": 3,
      "max": 9,
      "step": 2,
      "unit": "s",
      "label": "t:sections.highlight-media-with-text.settings.change_slides_speed.label",
      "default": 5
    },
    {
      "type": "select",
      "id": "media_ratio",
      "label": "t:sections.highlight-media-with-text.settings.media_ratio.label",
      "default": "portrait",
      "options": [
        {
          "value": "landscape",
          "label": "t:sections.all.image_ratio.landscape.label"
        },
        {
          "value": "square",
          "label": "t:sections.all.image_ratio.square.label"
        },
        {
          "value": "portrait",
          "label": "t:sections.all.image_ratio.portrait.label"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.all.headers.content"
    },
    {
      "type": "select",
      "id": "heading_style",
      "label": "t:sections.highlight-media-with-text.settings.heading_style.label",
      "default": "separate",
      "options": [
        {
          "value": "separate",
          "label": "t:sections.highlight-media-with-text.settings.heading_style.separate.label"
        },
        {
          "value": "overlap",
          "label": "t:sections.highlight-media-with-text.settings.heading_style.overlap.label"
        }
      ]
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label":"t:sections.best-categories.settings.heading.label",
      "default": "Heading here"
    },
    {
      "type": "select",
      "id": "heading_font",
      "default": "heading-font",
      "label": "t:sections.all.heading_font.label",
      "options": [
        {
          "value": "heading-font",
          "label": "t:sections.all.heading_font.heading-font.label"
        },
        {
          "value": "body-font",
          "label": "t:sections.all.heading_font.body-font.label"
        },
        {
          "value": "accent-font",
          "label": "t:sections.all.heading_font.accent-font.label"
        }
      ]
    },
    {
      "type": "range",
      "id": "desktop_font_size",
      "label": "t:sections.highlight-media-with-text.settings.desktop_font_size.label",
      "default": 140,
      "min": 20,
      "max": 160,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "mobile_font_size",
      "label": "t:sections.highlight-media-with-text.settings.mobile_font_size.label",
      "default": 30,
      "min": 20,
      "max": 50,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "t:settings_schema.global.settings.description.label",
      "default": "Add short description for this section."
    },
    {
      "type": "select",
      "id": "description_size",
      "label": "t:sections.all.description_size.label",
      "default": "text",
      "options": [
        {
          "label": "t:sections.all.description_size.text-xsmall.label",
          "value": "text-xs"
        },
        {
          "label": "t:sections.all.description_size.text-small.label",
          "value": "text-sm"
        },
        {
          "label": "t:sections.all.description_size.text.label",
          "value": "text"
        },
        {
          "label": "t:sections.all.description_size.text-medium.label",
          "value": "text-md"
        },
        {
          "label": "t:sections.all.description_size.text-large.label",
          "value": "text-lg"
        },
        {
          "label": "t:sections.all.description_size.text-xlarge.label",
          "value": "text-xl"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.all.headers.background_shape"
    },
    {
      "type": "select",
      "id": "shape",
      "default": "none",
      "label": "t:sections.all.shape.label",
      "options": [
        {
            "value": "none",
            "label": "t:sections.all.shape.none.label"
          },
          {
            "value": "curve",
            "label": "t:sections.all.shape.curve.label"
          },
          {
            "value": "deep_curve",
            "label": "t:sections.all.shape.deep_curve.label"
          },
          {
            "value": "cloud",
            "label": "t:sections.all.shape.cloud.label"
          },
          {
            "value": "wavelong",
            "label": "t:sections.all.shape.wave_long.label"
          },
          {
            "value": "wave",
            "label": "t:sections.all.shape.wave.label"
          },
          {
            "value": "mountain",
            "label": "t:sections.all.shape.mountain.label"
          },
          {
            "value": "brush-effect",
            "label": "t:sections.all.shape.brush-effect.label"
          }
      ]
    },
    {
      "type": "checkbox",
      "id": "flip_shape",
      "label": "t:sections.all.shape_position.flip_shape.label",
      "default": false
    },
    {
      "type": "select",
      "id": "shape_position",
      "default": "bottom",
      "label": "t:sections.all.shape_position.label",
      "options": [
        {
          "value": "top",
          "label": "t:sections.all.shape_position.top.label"
        },
        {
          "value": "bottom",
          "label": "t:sections.all.shape_position.bottom.label"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.all.spacing.section_spacing_heading"
    },
    {
      "type": "range",
      "id": "top_space_desktop",
      "label": "t:sections.all.spacing.top_space_desktop",
      "default": 70,
      "min": 0,
      "max": 150,
      "step": 5
    },
    {
      "type": "range",
      "id": "bottom_space_desktop",
      "label": "t:sections.all.spacing.bottom_space_desktop",
      "default": 70,
      "min": 0,
      "max": 150,
      "step": 5
    },
    {
      "type": "range",
      "id": "top_space_mobile",
      "label": "t:sections.all.spacing.top_space_mobile",
      "default": 40,
      "min": 0,
      "max": 100,
      "step": 5
    },
    {
      "type": "range",
      "id": "bottom_space_mobile",
      "label": "t:sections.all.spacing.bottom_space_mobile",
      "default": 40,
      "min": 0,
      "max": 100,
      "step": 5
    }
  ],
  "blocks": [
    {
      "type": "media",
      "name": "t:sections.highlight-media-with-text.blocks.media.name",
      "limit": 6,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "t:sections.highlight-media-with-text.blocks.media.settings.image.label"
        },
        {
          "type": "video",
          "id": "video",
          "label": "t:sections.highlight-media-with-text.blocks.media.settings.video.label"
        },
        {
          "type": "url",
          "id": "media_link",
          "label": "t:sections.all.button_link.label"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.highlight-media-with-text.presets.name",
      "blocks": [
        {
          "type": "media"
        },
        {
          "type": "media"
        },
        {
          "type": "media"
        },
        {
          "type": "media"
        }
      ]
    }
  ]
}
{% endschema %}
