{% if section.index <= 2 %}
  {{ 'icon-with-text.css' | asset_url | preload_tag: as: 'style' }}
{% endif %}
{{ 'icon-with-text.css' | asset_url | stylesheet_tag }}
{% liquid
  if section.settings.section_container_width == 'global'
    assign containerClass = settings.container_width
  else
    assign containerClass = section.settings.section_container_width
  endif 
%}
<div class="section-wrapper scheme-{{ section.settings.color_scheme }} section-spacing section-{{ section.settings.section_background }} background-style-{{ section.settings.background_style }}">
  <div class="{{ containerClass }}">
    <{% if settings.enable_card_animation %}animate-motion-list{% else %}div{% endif %} class="icon-with-text d-grid{% if section.settings.mobile_swipe %} mobile-swipe{% endif %}">
      {% for block in section.blocks %}
        <div
          id="textwithicon-{{ block.id }}"
          class="icon-with-text-item d-flex icon-{{ section.settings.icon_position }} {{ section.settings.content_alignment }}"
          data-motion-list>
          {% if block.settings.icon_list != 'none' or block.settings.custom_icon != blank %}
            <div class="icon-with-text-icon{% if section.settings.bg_shape != 'none' %} icon-with-bg-shape{% endif %} icon-{{ section.settings.icon_size }}" {{ block.settings.icon_list }}>
              {%- liquid
                assign image_ratio = 1 | divided_by: block.settings.icon.aspect_ratio | times: 100 | append: '%'
              %}
              <div class="media-box icon-{{ section.settings.icon_size }}" style="--image-ratio: {{ image_ratio }};">
                {% if block.settings.custom_icon != blank %}
                  {% render 'lazy-images'
                    , image: block.settings.custom_icon %}
                {% else %}
                  {% render 'icons'
                    , icon: block.settings.icon_list %}
                {% endif %}
              </div>
              {% if section.settings.bg_shape != 'none' %}
                <div class="icon-with-text-icon-image">
                  {%- render 'bg-shape'
                    , shape: section.settings.bg_shape -%}
                </div>
              {% endif %}
            </div>
          {% endif %}
          <div class="icon-with-text-text">
            {% if block.settings.heading != blank %}
              <{{ section.settings.block_seo_heading }} class="icon-with-text-heading {{ section.settings.block_heading_size }} {{ section.settings.block_heading_font }}">
              {%- capture markersPrefix -%}
                <span class="markers-text {{ section.settings.block_markers_font }}">
              {%- endcapture -%} 
              {%- capture markersSuffix -%}
                </span>
              {%- endcapture -%}
                {{- block.settings.heading | replace: '++', '<br/>' | replace: "[", markersPrefix | replace: "]", markersSuffix -}}
                </{{ section.settings.block_seo_heading }}>
              {% endif %}
              {% if block.settings.description != blank %}
                <p class="icon-with-text-desc {{ section.settings.block_description_size }}">
                  {{ block.settings.description | newline_to_br }}
                </p>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </{% if settings.enable_card_animation %}animate-motion-list{% else %}div{% endif %}>
    </div>
  </div>
  <style>
    #shopify-section-{{ section.id }} {
      --top-spacing: {{ section.settings.top_space_desktop }}px;
      --bottom-spacing: {{ section.settings.bottom_space_desktop }}px;
      --column-count: {{ section.settings.column_count }};
    }

    {% for block in section.blocks %}
      #textwithicon-{{ block.id }} {
        --shape-color: {{ block.settings.shape_color }};
        --icon-color: {{ block.settings.icon_color }};
      }
    {% endfor %}

    @media only screen and (max-width: 1279px) {
      #shopify-section-{{ section.id }} {
        {% if section.settings.column_count > 4 %}
          --column-count: 4;
        {% else %}
         --column-count: {{ section.settings.column_count }};
       {% endif %}
    } 
    }
    @media only screen and (max-width: 991px) {
      #shopify-section-{{ section.id }} {
        {% if section.settings.column_count > 3 %}
          --column-count: 3;
        {% else %}
         --column-count: {{ section.settings.column_count }};
       {% endif %}
      } 
    }

    @media only screen and (max-width: 767px) {
      #shopify-section-{{ section.id }} {
        --top-spacing: {{ section.settings.top_space_mobile }}px;
        --bottom-spacing: {{ section.settings.bottom_space_mobile }}px;
        --column-count: {{ section.settings.column_count_mobile }}
      }
    }
    {% if section.settings.section_visibility == 'large' %}
      @media(max-width: 767px) {
        #shopify-section-{{ section.id }} {
          display: none !important;
        }
      }
    {% elsif section.settings.section_visibility == 'small' %}
    @media(min-width: 768px) {
      #shopify-section-{{ section.id }} {
        display: none !important;
      }
    }
  {% endif %}
  </style>
  {% schema %}
    {
      "name": "t:sections.icon-with-text.name",
      "tag": "section",
      "class": "icon-with-text-section",
      "disabled_on": {
        "groups": ["header", "custom.Overlay"]
      },
      "settings": [
        {
          "type": "select",
          "id": "section_visibility",
          "label": "t:sections.all.section_visibility.label",
          "default": "always",
          "options": [
            {
              "label": "t:sections.all.section_visibility.always.label",
              "value": "always"
            },
            {
              "label": "t:sections.all.section_visibility.small.label",
              "value": "small"
            },
            {
              "label": "t:sections.all.section_visibility.large.label",
              "value": "large"
            }
          ]
        },
        {
          "type": "color_scheme",
          "id": "color_scheme",
          "label": "t:sections.all.colors.label",
          "default": "primary"
        },
        {
          "type": "select",
          "id": "section_background",
          "label": "t:sections.all.section_background.label",
          "default": "solid",
          "options": [
            {
              "label": "t:sections.all.section_background.solid.label",
              "value": "solid"
            },
            {
              "label": "t:sections.all.section_background.gradient.label",
              "value": "gradient"
            }
          ]
        },
        {
          "type": "select",
          "id": "section_container_width",
          "label": "t:sections.all.section_container_width.label",
          "default": "global",
          "options": [
            {
              "label": "t:sections.all.section_container_width.global.label",
              "value": "global"
            },
            {
              "label": "t:sections.all.section_container_width.container-sm.label",
              "value": "container-sm"
            },
            {
              "label": "t:sections.all.section_container_width.container.label",
              "value": "container-md"
            },
            {
              "label": "t:sections.all.section_container_width.container-md.label",
              "value": "container"
            },
            {
              "label": "t:sections.all.section_container_width.container-fullwidth.label",
              "value": "container-fullwidth"
            },
            {
              "label": "t:sections.all.section_container_width.no-container.label",
              "value": "no-container"
            }
          ]
        },
        {
          "type": "select",
          "id": "background_style",
          "label": "t:sections.icon-with-text.settings.background_style.label",
          "default": "none",
          "options": [
            {
              "label": "t:sections.icon-with-text.settings.background_style.options.background_card.label",
              "value": "background_card"
            },
            {
              "label": "t:sections.icon-with-text.settings.background_style.options.column_card.label",
              "value": "column_card"
            },
            {
              "label": "t:sections.icon-with-text.settings.background_style.options.column_border.label",
              "value": "column_border"
            },
            {
              "label": "t:sections.icon-with-text.settings.background_style.options.none.label",
              "value": "none"
            }
          ]
        },
        {
          "type": "header",
          "content": "t:sections.icon-with-text.settings.header.column"
        },
        {
          "type": "range",
          "id": "column_count",
          "min": 2,
          "max": 6,
          "step": 1,
          "default": 5,
          "label": "t:sections.icon-with-text.settings.column_count.label"
        },
        {
          "type": "radio",
          "id": "column_count_mobile",
          "label": "t:sections.icon-with-text.settings.column_count_mobile.label",
          "default": "2",
          "options": [
            {
              "value": "1",
              "label": "1"
            },
            {
              "value": "2",
              "label": "2"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "mobile_swipe",
          "label": "t:sections.icon-with-text.settings.mobile_swipe.label",
          "default": true
        },
        {
          "type": "select",
          "id": "content_alignment",
          "label": "t:sections.all.content_alignment.label",
          "default": "text-left",
          "options": [
            {
              "label": "t:sections.all.content_alignment.options.left.label",
              "value": "text-left"
            },
            {
              "label": "t:sections.all.content_alignment.options.center.label",
              "value": "text-center"
            },
            {
              "label": "t:sections.all.content_alignment.options.right.label",
              "value": "text-right"
            }
          ]
        },
        {
          "type": "header",
          "content": "t:sections.icon-with-text.settings.header.icon"
        },
        {
          "type": "select",
          "id": "icon_position",
          "default": "left",
          "label": "t:sections.icon-with-text.settings.icon_position.label",
          "options": [
            {
              "value": "top",
              "label": "t:sections.icon-with-text.settings.icon_position.options.top.label"
            },
            {
              "value": "left",
              "label": "t:sections.icon-with-text.settings.icon_position.options.left.label"
            },
            {
              "value": "right",
              "label": "t:sections.icon-with-text.settings.icon_position.options.right.label"
            }
          ]
        },
        {
          "type": "select",
          "id": "bg_shape",
          "label": "t:sections.icon-with-text.blocks.icon-with-text.settings.bg_shape.label",
          "default": "none",
          "options": [
            {
              "value": "none",
              "label": "t:sections.icon-with-text.blocks.icon-with-text.settings.bg_shape.options.none.label"
            },
            {
              "value": "sun",
              "label": "t:sections.icon-with-text.blocks.icon-with-text.settings.bg_shape.options.star.label"
            },
            {
              "value": "circle",
              "label": "t:sections.icon-with-text.blocks.icon-with-text.settings.bg_shape.options.circle.label"
            }
          ]
        },
        {
          "type": "select",
          "id": "icon_size",
          "default": "medium",
          "label": "t:sections.icon-with-text.settings.icon_size.label",
          "options": [
            {
              "value": "small",
              "label": "t:sections.icon-with-text.settings.icon_size.options.small.label"
            },
            {
              "value": "medium",
              "label": "t:sections.icon-with-text.settings.icon_size.options.medium.label"
            },
            {
              "value": "large",
              "label": "t:sections.icon-with-text.settings.icon_size.options.large.label"
            }
          ]
        },
        {
          "type": "header",
          "content": "t:sections.icon-with-text.blocks.icon-with-text.settings.header.block_content"
        },
        {
          "type": "select",
          "id": "block_heading_size",
          "label": "t:sections.all.heading_size.label",
          "default": "h6",
          "options": [
              {
                "value": "h4",
                "label": "t:sections.all.heading_size.heading_h4.label"
              },
              {
                "value": "h5",
                "label": "t:sections.all.heading_size.heading_h5.label"
              },
              {
                "value": "h6",
                "label": "t:sections.all.heading_size.heading_h6.label"
              },
              {
                "label": "t:sections.all.font_size.large.label",
                "value": "text-lg"
              },
              {
                "label": "t:sections.all.font_size.medium.label",
                "value": "text-md"
              },
              {
                "label": "t:sections.all.font_size.normal.label",
                "value": "text"
              },
              {
                "label": "t:sections.all.font_size.small.label",
                "value": "text-sm"
              },
              {
                "label": "t:sections.all.font_size.x_small.label",
                "value": "text-xs"
              }
          ]
        },
        {
          "type": "select",
          "id": "block_seo_heading",
          "label": "t:sections.all.seo_heading.label",
          "info": "t:sections.all.seo_heading.info",
          "default": "h4",
          "options": [
            {
              "value": "h1",
              "label": "H1"
            },
            {
              "value": "h2",
              "label": "H2"
            },
            {
              "value": "h3",
              "label": "H3"
            },
            {
              "value": "h4",
              "label": "H4"
            },
            {
              "value": "h5",
              "label": "H5"
            },
            {
              "value": "h6",
              "label": "H6"
            },
            {
              "value": "div",
              "label": "div"
            },
            {
              "value": "span",
              "label": "span"
            },
            {
              "value": "p",
              "label": "p"
            }
          ]
        },
        {
          "type": "select",
          "id": "block_heading_font",
          "default": "heading-font",
          "label": "t:sections.all.heading_font.label",
          "options": [
            {
              "value": "heading-font",
              "label": "t:sections.all.heading_font.heading-font.label"
            },
            {
              "value": "body-font",
              "label": "t:sections.all.heading_font.body-font.label"
            },
            {
              "value": "accent-font",
              "label": "t:sections.all.heading_font.accent-font.label"
            }
          ]
        },
        {
        "type": "select",
        "id": "block_markers_font",
        "default": "accent-font",
        "label": "t:sections.all.markers_font.label",
        "options": [
          {
            "value": "heading-font",
            "label": "t:sections.all.markers_font.heading-font.label"
          },
          {
            "value": "body-font",
            "label": "t:sections.all.markers_font.body-font.label"
          },
          {
            "value": "accent-font",
            "label": "t:sections.all.markers_font.accent-font.label"
          }
        ]
      },
        {
          "type": "select",
          "id": "block_description_size",
          "label": "t:sections.all.description_size.label",
          "default": "text",
          "options": [
            {
              "label": "t:sections.all.description_size.text-xsmall.label",
              "value": "text-xs"
            },
            {
              "label": "t:sections.all.description_size.text-small.label",
              "value": "text-sm"
            },
            {
              "label": "t:sections.all.description_size.text.label",
              "value": "text"
            },
            {
              "label": "t:sections.all.description_size.text-medium.label",
              "value": "text-md"
            },
            {
              "label": "t:sections.all.description_size.text-large.label",
              "value": "text-lg"
            },
            {
              "label": "t:sections.all.description_size.text-xlarge.label",
              "value": "text-xl"
            }
          ]
        },
        {
          "type": "header",
          "content": "t:sections.all.spacing.section_spacing_heading"
        },
        {
          "type": "range",
          "id": "top_space_desktop",
          "label": "t:sections.all.spacing.top_space_desktop",
          "default": 50,
          "min": 0,
          "max": 150,
          "step": 5
        },
        {
          "type": "range",
          "id": "bottom_space_desktop",
          "label": "t:sections.all.spacing.bottom_space_desktop",
          "default": 50,
          "min": 0,
          "max": 150,
          "step": 5
        },
        {
          "type": "range",
          "id": "top_space_mobile",
          "label": "t:sections.all.spacing.top_space_mobile",
          "default": 20,
          "min": 0,
          "max": 100,
          "step": 5
        },
        {
          "type": "range",
          "id": "bottom_space_mobile",
          "label": "t:sections.all.spacing.bottom_space_mobile",
          "default": 20,
          "min": 0,
          "max": 100,
          "step": 5
        }
      ],
      "blocks": [
        {
          "type": "icon-with-text",
          "name": "t:sections.icon-with-text.blocks.icon-with-text.name",
          "settings": [
            {
              "type": "select",
              "id": "icon_list",
              "label": "t:sections.icon-with-text.blocks.icon-with-text.settings.icon.label",
              "default": "global",
              "options": [
                {
                  "value": "none",
                  "label": "t:sections.icons.none.label"
                },
                {
                  "value": "chat",
                  "label": "t:sections.icons.chat.label"
                },
                {
                  "value": "eye",
                  "label": "t:sections.icons.eye.label"
                },
                {
                  "value": "gift",
                  "label": "t:sections.icons.gift.label"
                },
                {
                  "value": "global",
                  "label": "t:sections.icons.global.label"
                },
                {
                  "value": "heart",
                  "label": "t:sections.icons.heart.label"
                },
                {
                  "value": "phone",
                  "label": "t:sections.icons.phone.label"
                },
                {
                  "value": "refund",
                  "label": "t:sections.icons.refund.label"
                },
                {
                  "value": "secure",
                  "label": "t:sections.icons.secure.label"
                },
                {
                  "value": "shipping",
                  "label": "t:sections.icons.shipping.label"
                },
                {
                  "value": "support",
                  "label": "t:sections.icons.support.label"
                },
                {
                  "value": "user",
                  "label": "t:sections.icons.user.label"
                },
                {
                  "value": "date",
                  "label": "t:sections.icons.date.label"
                },
                {
                  "value": "home",
                  "label": "t:sections.icons.home.label"
                },
                {
                  "value": "notification",
                  "label": "t:sections.icons.notification.label"
                },
                {
                  "value": "settings",
                  "label": "t:sections.icons.settings.label"
                },
                {
                  "value": "star",
                  "label": "t:sections.icons.star.label"
                }
              ]
            },
            {
              "type": "image_picker",
              "id": "custom_icon",
              "label": "t:sections.icon-with-text.blocks.icon-with-text.settings.custom_icon.label",
              "info": "t:sections.icon-with-text.blocks.icon-with-text.settings.custom_icon.info"
            },
            {
              "type": "inline_richtext",
              "id": "heading",
              "label": "t:settings_schema.global.settings.heading.label",
              "info": "t:settings_schema.global.settings.heading.info",
              "default": "Heading here"
            },
            {
              "type": "textarea",
              "id": "description",
              "label": "t:settings_schema.global.settings.description.label"
            },
            {
              "type": "header",
              "content": "t:sections.icon-with-text.settings.header.color"
            },
            {
              "type": "color",
              "id": "shape_color",
              "label": "t:sections.icon-with-text.blocks.icon-with-text.settings.shap_color.label",
              "default": "#FFFFFF"
            },
            {
              "type": "color",
              "id": "icon_color",
              "label": "t:sections.icon-with-text.blocks.icon-with-text.settings.icon_color.label",
              "default": "#000000"
            }
          ]
        }
      ],
      "presets": [
        {
          "name": "t:sections.icon-with-text.presets.name",
          "blocks": [
            {
              "type": "icon-with-text"
            },
            {
              "type": "icon-with-text"
            },
            {
              "type": "icon-with-text"
            },
            {
              "type": "icon-with-text"
            },
            {
              "type": "icon-with-text"
            }
          ]
        }
      ]
    }
  {% endschema %}