{% comment %} 
      {% if section.index <= 2 %} 
      {{ 'marquee.css' | asset_url | preload_tag: as: 'style' }}
      {% endif %}
      {{ 'marquee.css' | asset_url | stylesheet_tag }} 
{% endcomment %}

{%- capture corner_style -%}
  {% if section.settings.corner_style == 'top' %}
      round-section round-top
      {% elsif section.settings.corner_style == 'bottom' %}
      round-section round-bottom
      {% elsif section.settings.corner_style == 'both' %}
      round-section round-bottom round-top
  {% endif %}
  {%- endcapture -%}

{% liquid
  if section.settings.section_container_width == 'global'
    assign containerClass = settings.container_width
  else
    assign containerClass = section.settings.section_container_width
  endif
  if section.settings.marquee_direction == 'rtl'
    assign marquee_direction_arch = 4000
  else
    assign marquee_direction_arch = -4000
  endif
%}

<div class="section-wrapper section-spacing scheme-{{ section.settings.color_scheme }} {{ corner_style }} section-{{ section.settings.section_background }} border-enable-{{ section.settings.enable_border }}">
  <div class="{{ containerClass }}">
    <marquee-content>

      <div class="marquee-wrapper" aria-hidden="true">
        <div
          class="marquee-content-wrap{% if section.settings.rotation_style == 'always' %} autoplay-infinite{% endif %} {{ section.settings.marquee_direction }}-direction"
          {% if section.settings.rotation_style == 'onscroll' %}
          data-marquee-onscroll
          data-marquee-speed="{{ section.settings.scrolling_speed }}"
          data-marquee-speed-mobile="{{ section.settings.scrolling_speed_mobile }}"
          data-marquee-direction="{{ section.settings.marquee_direction }}"
          {% endif %}
          data-marquee-wrapper>
          {% for i in (1..10) %}
            <div class="marquee-item">
              {% for block in section.blocks %}

                {% liquid
                  assign show_image_hover = false
                  if block.settings.marquee_text != blank and block.settings.marquee_image != blank and block.settings.image_visibility == 'on_hover'
                    assign show_image_hover = true
                  endif
                %}

                {% if block.settings.marquee_text != blank %}
                  <div class="marquee-text-block{% if show_image_hover %} show-image-on-hover{% endif %}">
                    <div class="marquee-text {{ section.settings.heading_font }}">
                      {%- capture markersPrefix -%}
                        <span class="{{ section.settings.markers_text_style }} {{ section.settings.markers_font }}">
                      {%- endcapture -%}
                      {{ block.settings.marquee_text
 | replace: '[', markersPrefix
 | replace: ']', '</span>'
                      }}
                    </div>

                    {% if show_image_hover %}
                      <div class="marquee-icon">
                        {{ block.settings.marquee_image | image_url: width: null | image_tag }}
                      </div>
                    {% endif %}
                  </div>
                {% endif %}
                {% if block.settings.marquee_image != blank %}
                  <div class="marquee-icon{% if show_image_hover %} marquee-image-for-mobile{% endif %}">
                    {{ block.settings.marquee_image | image_url: width: null | image_tag }}
                  </div>
                {% endif %}

              {% endfor %}
            </div>
          {% endfor %}
        </div>
      </div>

    </marquee-content>
  </div>
</div>

<style>
  #shopify-section-{{ section.id }} {
    --top-spacing: {{ section.settings.top_space_desktop }}px;
    --bottom-spacing: {{ section.settings.bottom_space_desktop }}px;
    --marquee-speed: {{ section.settings.scrolling_speed }}s;
    --marque-image-width: {{ section.settings.desktop_image_width }}px;

    {% if section.settings.marquee_font_size == 'custom_font' %}
    --marque-text-size: {{ section.settings.desktop_font_size }}px;
    {% else %}
    --marque-text-size: var(--{{ section.settings.marquee_font_size }});
    {% endif %}
    --marguee-item-space: {{ section.settings.sapce_between_text_desktop }}px;
    --rotate: {{ section.settings.rotation }}deg;
    --round-section-radius: {{ section.settings.corner_radius }}px;
    --marquee-images-radius: {{ section.settings.marquee_images_radius }}px;
  }
  @media only screen and (max-width: 767px) {
    #shopify-section-{{ section.id }} {
      --top-spacing: {{ section.settings.top_space_mobile }}px;
      --bottom-spacing: {{ section.settings.bottom_space_mobile }}px;
      --marquee-speed: {{ section.settings.scrolling_speed_mobile }}s !important;
      --marque-image-width: {{ section.settings.mobile_image_width }}px;
      {% if section.settings.marquee_font_size == 'custom_font' %}
       --marque-text-size: {{ section.settings.mobile_font_size }}px;
      {% else %}
       --marque-text-size: var(--{{ section.settings.marquee_font_size }});
      {% endif %}
      --marguee-item-space: {{ section.settings.sapce_between_text_mobile }}px;
    }
  }
  {% if section.settings.section_visibility == 'large' %}
    @media(max-width: 767px) {
      #shopify-section-{{ section.id }} {
        display: none !important;
      }
    }
  {% elsif section.settings.section_visibility == 'small' %}
  @media(min-width: 768px) {
    #shopify-section-{{ section.id }} {
      display: none !important;
    }
  }
{% endif %}

</style>
{% schema %}
  {
    "name": "t:sections.marquee.name",
    "tag": "section",
    "class": "marquee-section",
    "disabled_on": {
      "groups": ["header", "footer", "custom.Overlay"]
    },
    "settings": [
      {
        "type": "select",
        "id": "section_visibility",
        "label": "t:sections.all.section_visibility.label",
        "default": "always",
        "options": [
          {
            "label": "t:sections.all.section_visibility.always.label",
            "value": "always"
          },
          {
            "label": "t:sections.all.section_visibility.small.label",
            "value": "small"
          },
          {
            "label": "t:sections.all.section_visibility.large.label",
            "value": "large"
          }
        ]
      },
      {
        "type": "color_scheme",
        "id": "color_scheme",
        "label": "t:sections.all.colors.label",
        "default": "secondary"
      },
      {
        "type": "select",
        "id": "section_background",
        "label": "t:sections.all.section_background.label",
        "default": "solid",
        "options": [
          {
            "label": "t:sections.all.section_background.solid.label",
            "value": "solid"
          },
          {
            "label": "t:sections.all.section_background.gradient.label",
            "value": "gradient"
          }
        ]
      },
      {
        "type": "select",
        "id": "section_container_width",
        "label": "t:sections.all.section_container_width.label",
        "default": "no-container",
        "options": [
          {
            "label": "t:sections.all.section_container_width.global.label",
            "value": "global"
          },
          {
            "label": "t:sections.all.section_container_width.container-sm.label",
            "value": "container-sm"
          },
          {
              "label": "t:sections.all.section_container_width.container.label",
              "value": "container-md"
            },
            {
              "label": "t:sections.all.section_container_width.container-md.label",
              "value": "container"
            },
          {
            "label": "t:sections.all.section_container_width.container-fullwidth.label",
            "value": "container-fullwidth"
          },
          {
            "label": "t:sections.all.section_container_width.no-container.label",
            "value": "no-container"
          }
        ]
      },
      {
        "type": "select",
        "id": "corner_style",
        "default": "none",
        "label": "t:sections.all.section_corner_style.label",
        "options": [
          {
            "value": "top",
            "label": "t:sections.all.section_corner_style.top.label"
          },
          {
            "value": "bottom",
            "label": "t:sections.all.section_corner_style.bottom.label"
          },
          {
            "value": "both",
            "label": "t:sections.all.section_corner_style.both.label"
          },
          {
            "value": "none",
            "label": "t:sections.all.section_corner_style.none.label"
          }
        ]
      },
      {
        "type": "range",
        "id": "corner_radius",
        "label": "t:settings_schema.global.settings.corner_radius.label",
        "default": 20,
        "min": 0,
        "max": 100,
        "step": 5,
        "unit": "px"
      },
      {
        "type": "checkbox",
        "id": "enable_border",
        "label": "t:sections.featured-product.settings.enable_images_border.label",
        "default": false
      },
      {
        "type": "header",
        "content": "t:sections.all.headers.marquee"
      },
      {
        "type": "select",
        "id": "marquee_direction",
        "default": "rtl",
        "label": "t:sections.all.marquee_direction.label",
        "options": [
          {
            "value": "rtl",
            "label": "t:sections.all.marquee_direction.rtl.label"
          },
          {
            "value": "ltr",
            "label": "t:sections.all.marquee_direction.ltr.label"
          }
        ]
      },
      {
        "type": "select",
        "id": "rotation_style",
        "label": "t:sections.marquee.settings.rotation_style.label",
        "default": "always",
        "options": [
          {
            "value": "onscroll",
            "label": "t:sections.marquee.settings.rotation_style.onscroll.label"
          },
          {
            "value": "always",
            "label": "t:sections.marquee.settings.rotation_style.always.label"
          }
        ]
      },
      {
        "type": "range",
        "id": "rotation",
        "label": "t:sections.marquee.settings.rotation.label",
        "default": 0,
        "min": -5,
        "max": 5,
        "step": 1,
        "unit": "deg"
      },
      {
        "type": "select",
        "id": "heading_font",
        "default": "heading-font",
        "label": "t:sections.all.heading_font.label",
        "options": [
          {
            "value": "heading-font",
            "label": "t:sections.all.heading_font.heading-font.label"
          },
          {
            "value": "body-font",
            "label": "t:sections.all.heading_font.body-font.label"
          },
          {
            "value": "accent-font",
            "label": "t:sections.all.heading_font.accent-font.label"
          }
        ]
      },
      {
        "type": "select",
        "id": "markers_font",
        "default": "accent-font",
        "label": "t:sections.all.markers_font.label",
        "options": [
          {
            "value": "heading-font",
            "label": "t:sections.all.markers_font.heading-font.label"
          },
          {
            "value": "body-font",
            "label": "t:sections.all.markers_font.body-font.label"
          },
          {
            "value": "accent-font",
            "label": "t:sections.all.markers_font.accent-font.label"
          }
        ]
      },
      {
        "type": "select",
        "id": "markers_text_style",
        "default": "no-markers",
        "label": "t:sections.marquee.settings.markers_text_style.label",
        "options": [
          {
            "value": "no-markers",
            "label": "t:sections.marquee.settings.markers_text_style.no-markers.label"
          },
          {
            "value": "text-stroke",
            "label": "t:sections.marquee.settings.markers_text_style.text-stroke.label"
          }
        ]
      },
      {
        "type": "range",
        "id": "marquee_images_radius",
        "label": "t:sections.marquee.settings.marquee_images_radius.label",
        "default": 27,
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px"
      },
      {
        "type": "header",
        "content": "t:sections.all.headers.font_size"
      },
      {
        "type": "select",
        "id": "marquee_font_size",
        "default": "custom_font",
        "label": "t:sections.marquee.settings.marquee_font_size.label",
        "options": [
          {
            "label": "t:sections.all.description_size.text-small.label",
            "value": "text-sm"
          },
          {
            "label": "t:sections.all.description_size.text-medium.label",
            "value": "text-md"
          },
          {
            "label": "t:sections.all.description_size.text-large.label",
            "value": "text-lg"
          },
          {
            "value": "custom_font",
            "label": "t:sections.marquee.settings.marquee_font_size.custom_font.label"
          }
        ]
      },
      {
        "type": "range",
        "id": "desktop_font_size",
        "label": "t:sections.marquee.settings.desktop_font_size.label",
        "visible_if": "{{ section.settings.marquee_font_size == 'custom_font' }}",
        "default": 48,
        "min": 20,
        "max": 150,
        "step": 2,
        "unit": "px"
      },
      {
        "type": "range",
        "id": "mobile_font_size",
        "label": "t:sections.marquee.settings.mobile_font_size.label",
        "visible_if": "{{ section.settings.marquee_font_size == 'custom_font' }}",
        "default": 20,
        "min": 20,
        "max": 50,
        "step": 1,
        "unit": "px"
      },
      {
        "type": "header",
        "content": "t:settings_schema.global.settings.speed.label"
      },
      {
        "type": "range",
        "id": "scrolling_speed",
        "label": "t:sections.marquee.settings.scrolling_speed.label",
        "min": 5,
        "max": 100,
        "step": 1,
        "unit": "s",
        "default": 26
      },
      {
        "type": "range",
        "id": "scrolling_speed_mobile",
        "label": "t:sections.marquee.settings.scrolling_speed_mobile.label",
        "min": 5,
        "max": 100,
        "step": 1,
        "unit": "s",
        "default": 14
      },
      {
        "type": "header",
        "content": "t:sections.marquee.settings.header.item_space"
      },
      {
        "type": "range",
        "id": "sapce_between_text_desktop",
        "label": "t:sections.marquee.settings.sapce_between_text_desktop.label",
        "default": 14,
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px"
      },
      {
        "type": "range",
        "id": "sapce_between_text_mobile",
        "label": "t:sections.marquee.settings.sapce_between_text_mobile.label",
        "default": 7,
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px"
      },
      {
        "type": "header",
        "content": "t:sections.marquee.settings.header.marquee_image_width"
      },
      {
        "type": "range",
        "id": "desktop_image_width",
        "label": "t:sections.all.headers.desktop",
        "default": 115,
        "min": 50,
        "max": 200,
        "step": 5,
        "unit": "px"
      },
      {
        "type": "range",
        "id": "mobile_image_width",
        "label": "t:sections.all.headers.mobile",
        "default": 65,
        "min": 50,
        "max": 200,
        "step": 5,
        "unit": "px"
      },
      {
        "type": "header",
        "content": "t:sections.all.spacing.section_spacing_heading"
      },
      {
        "type": "range",
        "id": "top_space_desktop",
        "label": "t:sections.all.spacing.top_space_desktop",
        "default": 20,
        "min": 0,
        "max": 150,
        "step": 5
      },
      {
        "type": "range",
        "id": "bottom_space_desktop",
        "label": "t:sections.all.spacing.bottom_space_desktop",
        "default": 20,
        "min": 0,
        "max": 150,
        "step": 5
      },
      {
        "type": "range",
        "id": "top_space_mobile",
        "label": "t:sections.all.spacing.top_space_mobile",
        "default": 15,
        "min": 0,
        "max": 100,
        "step": 5
      },
      {
        "type": "range",
        "id": "bottom_space_mobile",
        "label": "t:sections.all.spacing.bottom_space_mobile",
        "default": 15,
        "min": 0,
        "max": 100,
        "step": 5
      }
    ],
    "blocks": [
      {
        "type": "marquee-content",
        "name": "t:sections.marquee.blocks.marquee-content.name",
        "settings": [
          {
            "type": "inline_richtext",
            "id": "marquee_text",
            "label": "t:sections.marquee.blocks.marquee-content.settings.marquee_text.label",
            "default": "MARQUE [Text]",
            "info": "t:sections.marquee.blocks.marquee-content.settings.marquee_text.info"
          },
          {
            "type": "image_picker",
            "id": "marquee_image",
            "label": "t:sections.marquee.blocks.marquee-content.settings.marquee_image.label"
          },
          {
            "type": "select",
            "id": "image_visibility",
            "default": "default",
            "label": "t:sections.marquee.blocks.marquee-content.settings.image_visibility.label",
            "options": [
              {
                "value": "default",
                "label": "t:sections.marquee.blocks.marquee-content.settings.image_visibility.default.label"
              },
              {
                "value": "on_hover",
                "label": "t:sections.marquee.blocks.marquee-content.settings.image_visibility.on_hover.label"
              }
            ]
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "t:sections.marquee.presets.name",
        "blocks": [
          {
            "type": "marquee-content"
          },
          {
            "type": "marquee-content"
          }
        ]
      }
    ]
  }
{% endschema %}